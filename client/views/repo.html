<template name="repo">
	{{> header page="repository"}}
	<div class="ui page vertically padded grid">
		<div class="centered row">
			<div class="fourteen wide column">
				<div class="ui basic segment">
					<div class="ui grid">
						<div class="row">
							<div class="left aligned eight wide column">
								<h2 class="ui header">
									<a class="link-light" href="/{{user.profile.screen_name}}/rep">
										<span>{{user.profile.screen_name}}</span>
									</a>
									<span class="grey-light"> / </span>
									<span class="teal">#</span> {{repo.title}}
									<div class="sub header">
										{{#if repo.last_update}}
											Updated {{setLastUpdate repo.last_update}}
										{{else}}
											Created {{setLastUpdate repo.created_at}}
										{{/if}}	
									</div>
								</h2>
							</div>
							<div class="right aligned eight wide column">
								<div class="right aligned bottom aligned eight wide column">
									<!-- <div class="ui basic icon button">
										<i class="download icon"></i>
									</div>
									<div class="ui basic icon button">
										<i class="copy icon"></i>
									</div> -->
									<a id="fb_share" href="{{repo.permalink}}" class="ui basic icon button stackable">
										<i class="facebook facebook-color icon"></i>
									</a>
									<a href="http://twitter.com/intent/tweet{{twitterShareParams}}" class="ui basic icon button stackable">
										<i class="twitter twitter-color icon"></i>
									</a>
									<div id="subscribe" class="ui basic {{#if isOwner repoOwnerId}}yellow disabled{{/if}} button">
										<i class="star {{#if subscribed repo.subscribers}}yellow{{/if}} icon"></i>
										<span class="grey">{{#if repo.nb_subscribers}} {{repo.nb_subscribers}} {{else}} 0 {{/if}}</span>
									</div>
<!-- 									{{#if isOwner repoOwnerId}}

									{{else}}
									<div id="subscribe" class="ui basic vertical animated button stackable">
										<div class="hidden content">
											<i class="{{#if isOwner repoOwnerId}}empty{{/if}} star {{#if subscribed repo.subscribers}}yellow{{/if}} icon"></i>
										</div>
										<div class="visible content">
											<i class="star {{#if subscribed repo.subscribers}}yellow{{/if}} icon"></i>
											<span class="grey">{{#if repo.nb_subscribers}} {{repo.nb_subscribers}} {{else}} 0 {{/if}}</span>
										</div>
									</div>
									{{/if}} -->
								</div>
							</div>
						</div>
						<div class="row">
							<div class="ui grid">
								<div class="left aligned eight wide column">
									<div class="ui mini statistics">
										<div class="statistic">
											<div class="value">
												<i class="ui small blue camera grey-light circular inverted icon"></i>
											</div>
											<span class="blue">{{#if repo.nb_image}} {{repo.nb_image}} {{else}} 0 {{/if}}</span>
											<!-- <span class="label">Image</span> -->
										</div>
										<div class="statistic">
											<div class="value">
												<i class="ui small red record grey-light circular inverted icon"></i>
											</div>
											<span class="red">{{#if repo.nb_video}} {{repo.nb_video}} {{else}} 0 {{/if}}</span>
											<!-- <span class="label">Video</span> -->
										</div>
										<div class="statistic">
											<div class="value">
												<i class="ui small yellow unmute grey-light circular inverted icon"></i>
											</div>
											<span class="yellow">{{#if repo.nb_audio}} {{repo.nb_audio}} {{else}} 0 {{/if}}</span>
											<!-- <span class="label">Audio</span> -->
										</div>
										<div class="statistic">
											<div class="value">
												<i class="ui small file outline grey-light circular icon"></i>
											</div>
											<span class="grey-light">{{#if repo.nb_application}} {{repo.nb_application}} {{else}} 0 {{/if}}</span>
											<!-- <span class="label">Other</span> -->
										</div>
									</div>
								</div>
							</div>
						</div>


							<!-- <div class="left aligned eight wide column">
								<div class="ui mini statistics">
									<div class="statistic">
										<div class="value">
											<i class="ui download grey-light icon"></i>
										</div>
										<span>{{#if repo.nb_download}} {{repo.nb_download}} {{else}} 0 {{/if}}</span>
										<span class="label">Download</span>
									</div>
									<div class="statistic">
										<div class="value">
											<i class="ui star grey-light icon"></i>
										</div>
										<span>{{#if repo.nb_subscribers}} {{repo.nb_subscribers}} {{else}} 0 {{/if}}</span>
										<span class="label">Subscriber</span>
									</div>
									<div class="statistic">
										<div class="value">
											<i class="ui file grey-light icon"></i>
										</div>
										<span>{{#if repo.nb_files}} {{repo.nb_files}} {{else}} 0 {{/if}}</span>
										<span class="label">Files</span>
									</div>
								</div>
							</div> -->
						<!-- </div> -->
					</div>
				</div>




							
							<!-- <i class="star link {{#if subscribed}}yellow{{/if}} icon"></i>
							<i class="copy link icon"></i> -->

					<!-- <div class="ui hidden divider"></div>
					<a class="ui small yellow image label">
						<i class="star icon"></i>
						Subscriber
						<span class="detail">23 490</span>
					</a>
					<a class="ui small green image label">
						<i class="copy icon"></i>
						Copier
						<span class="detail">6375</span>
					</a>
					<a class="ui small purple image label">
						<i class="download icon"></i>
						Downloader
						<span class="detail">234</span>
					</a> -->

				<div class="ui segment">
					<div class="ui grid">
						<div class="left aligned ten wide column">
							<div class="ui buttons">
								<div id="history_dropdown" class="ui floating small basic pink labeled dropdown icon button stackable">
									<span class="text">History</span>
									<i class="history icon"></i>
									<div class="menu">
										<div class="item">
											<i class="clock icon"></i>
											Added 3 files, 1 folder one hour ago
										</div>
									</div>
								</div>
							</div>
							<div class="ui buttons">
								<div id="filter_dropdown" class="ui floating small basic blue labeled dropdown icon button stackable">
									<span class="text">Filter</span>
									<i class="filter icon"></i>
									<div class="menu">
										<div id="filter_all" class="item" data-value="all">
											<i class="list icon"></i>
											All
										</div>
										<div id="filter_image" class="item" data-value="image">
											<i class="blue camera icon"></i>
											Image
										</div>
										<div id="filter_video" class="item" data-value="video">
											<i class="red record icon"></i>
											Video
										</div>
										<div id="filter_audio" class="item" data-value="audio">
											<i class="yellow unmute icon"></i>
											Audio
										</div>
										<div id="filter_application" class="item" data-value="application">
											<i class="grey-light file outline icon"></i>
											Other
										</div>
									</div>
								</div>
							</div>
							{{#if repo.file_structure}}
								{{#if isOwner repoOwnerId}}
								<div class="ui buttons">
									<div id="add_dropdown" class="ui floating small basic teal labeled dropdown icon button stackable">
										<span class="text">Add Files</span>
										<i class="add icon"></i>
										<!-- <div class="menu">
											<div class="item">
												<i id="upload_button" class="file icon"></i>
												Add File(s)
											</div>
											<div class="item">
												<i class="linkify icon"></i>
												Add Link(s)
											</div>
										</div> -->
									</div>
								</div>
								{{/if}}
							{{/if}}
						</div>
						<div class="right aligned six wide column">
							{{#if tmpFiles}}
							<div class="ui teal label">
								{{#if nbTmpFiles}}{{nbTmpFiles}} new uploaded files{{/if}}
							</div>
							<div id="commit_cancel" class="ui basic compact icon red button">
								<i class="delete icon"></i>
							</div>
							<div  id="commit" class="ui basic compact icon green button">
								<i class="check icon"></i>
								Publish
							</div>
							{{/if}}
						</div>
					</div>
					<table id="file-list" class="ui small table grey-dark">
						<thead></thead>
	  					<tbody>
	  						<tr class="disabled">
								<td class="ten wide">Name</td>
								<td class="three wide right aligned">Size</td>
								<td class="three wide right aligned">Updated</td>
							</tr>
						{{#each tmpFiles}}
							<tr class="positive">
								<td>
									<i class="{{setIcon type.subtype}} icon"></i>
									<a href="#">{{title}}</a>
								</td>
								<td class="right aligned">{{#unless directory}}{{setSize size}}{{else}}-{{/unless}}</td>
								<td class="right aligned">-</td>
							</tr>
						{{/each}}
						{{#each filter repo.file_structure}}

									<!-- <i class="{{setIcon type.subtype}} icon"></i> -->
	<!-- 								<div class="ui mini yellow label">
										{{title}}
									</div> -->
							{{#if supported type.subtype}}
								{{#if equal type.subtype "audio"}}
								<tr>
									<td><i class="{{setIcon type.subtype}} yellow icon"></i>{{title}}</td>
									<td class="right aligned">{{setSize size}}</td>
									<td class="right aligned">{{setDate timestamp}}</td>
								</tr>
								<tr class="extra-content">
									<td colspan="3" style="border-top: 0px">
										<div class="ui tertiary raised yellow segment">
											<div class="ui grid">
												<div class="left aligned thirteen wide column grey-extra-light site-size">
													<a href="{{url}}" class="play-audio">
														<i class="audio play grey icon"></i>
													</a>
													<span class="grey-dark playing">Playing </span>
													{{title}}
												</div>
												<div class="right aligned three wide column grey site-size">
													<span class="timer">0:00</span>
												</div>
											</div>
	 										<!-- <div class="ui bottom orange disabled inverted attached progress">
												<div class="bar"></div>
											</div> -->
										</div>
									</td>
								</tr>
								{{/if}}

								{{#if equal type.subtype "image"}}
								<tr>
									<td><i class="{{setIcon type.subtype}} blue icon"></i>{{title}}</td>
									<td class="right aligned">{{setSize size}}</td>
									<td class="right aligned">{{setDate timestamp}}</td>
								</tr>
								<tr class="extra-content">
									<td colspan="3" style="border-top: 0px; text-align: center">
										<a class="cover" href="{{url}}">
											<img src="{{url}}" />
										</a>
										<div class="ui hidden divider"></div>
									</td>
								</tr>
								{{/if}}


								{{#if equal type.subtype "video"}}
								<tr>
									<td><i class="{{setIcon type.subtype}} red icon"></i>{{title}}</td>
									<td class="right aligned">{{setSize size}}</td>
									<td class="right aligned">{{setDate timestamp}}</td>
								</tr>
								<tr class="extra-content">
									<td colspan="3" style="border-top: 0px; text-align: center">
										<div class="ui basic segment">
											{{#if equal cover_url "/image_small.jpg"}}
											<div class="ui active inverted dimmer">
												<div class="ui large text loader">Generating thumbnail</div>
											</div>
											{{/if}}
											<a class="cover-video" href="{{url}}">
												<img src="{{cover_url}}" />
												<video controls>
													<source src="" type="video/mp4">
													Your browser does not support the video tag.
												</video>
											</a>
										</div>
										<div class="ui hidden divider"></div>
									</td>
								</tr>
								{{/if}}
							{{else}}
								<tr>
									<td>
										<i class="{{setIcon type.subtype}} icon"></i>
										<a href="{{url}}" target="_blank" >{{title}}</a>
									</td>
									<td class="right aligned">{{setSize size}}</td>
									<td class="right aligned">{{setDate timestamp}}</td>
								</tr>
							{{/if}}
						{{/each}}
						</tbody>
					</table>
					
					{{#unless repo.file_structure}}
					<div class="ui vertically padded grid">
						<div class="center aligned column">
							{{#if isOwner repoOwnerId}}
							<div class="ui yellow floating message">
								<div class="header">
									Wow, seems empty here!
								</div>
								Try to add some files to this repository before sharing it!
								<div class="ui hidden divider"></div>
								<div class="ui buttons">
									<div id="add_dropdown" class="ui floating yellow labeled dropdown icon button stackable">
										<span class="text">Add Files</span>
										<i class="add icon"></i>
										<!-- <div class="menu">
											<div class="item">
												<i id="upload_button" class="file icon"></i>
												Add File(s)
											</div>
											<div class="item">
												<i class="linkify icon"></i>
												Add Link(s)
											</div>
										</div> -->
									</div>
								</div>
							</div>
							{{else}}
							<div class="ui floating message">
								<div class="red header">
									Empty repository
									<i class="frown big icon"></i>
								</div>
								<div>
									<i class="file red massive icon"></i>
								</div>
								<div class="ui hidden divider"></div>
							</div>
							{{/if}}
						</div>
					</div>
					{{/unless}}
				</div>
			</div>
		</div>
	</div>
	
	{{#if errorMessage}}
		<div class="ui negative small message">
			<i class="close icon"></i>
			<div class="header">
				{{errorMessage}}
			</div>
		</div>
	{{/if}}

	{{> upload_modal}}
	{{> image_modal}}
	
</template>